<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lesson_18</title>
  </head>
  <body>
    <script>
      "use strict";

      // Задание : Я хочу, чтоб вы написали свой bind и чтоб было немного веселее, свою реализацию метода массива - map

      // 1. Метод arr.map вызывает функцию для каждого элемента массива и возвращает массив результатов выполнения этой функции.

      let arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];

      const map = function (array, cb, thisArg) {
        let res = [];

        for (let i = 0; i < array.length; i++) {
          res.push(cb.call(thisArg || array[i], array[i], i, array));
        }
        return res;
      };

      const arrToTen = map(
        arr,
        function (el, i) {
          return {
            index: i,
            value: el * 10,
          };
        },
        {}
      );

      console.log(arrToTen);

      // 2. Вызов f.bind(someObject) создает новую функцию с тем же телом и областью действия, что и f, но там, где в исходной функции используется this, в новой функции оно постоянно будет связано с первым аргументом bind, независимо от того, как функция используется.

      const bind = function (fn, thisContext) {
        let argsCount = 2;
        let restArgs = Array.prototype.slice.call(arguments, argsCount);

        return function () {
          let fnArgs = Array.prototype.slice.call(arguments);
          return fn.apply(thisContext, restArgs.concat(fnArgs));
        };
      };

      function sayHello(words) {
        return `${words} ${this.name}`;
      }

      let student = {
        name: "Kate",
        age: 25,
      };

      let foo = bind(sayHello, student, "Hello,");

      console.log(foo());
    </script>
  </body>
</html>
